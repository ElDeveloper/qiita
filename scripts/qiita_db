#!/usr/bin/env python

# -----------------------------------------------------------------------------
# Copyright (c) 2014--, The Qiita Development Team.
#
# Distributed under the terms of the BSD 3-clause License.
#
# The full license is in the file LICENSE, distributed with this software.
# -----------------------------------------------------------------------------

import click

from qiita_db.util import get_filetypes
from qiita_db.data import load_raw
from qiita_db.commands import make_study_from_cmd


@click.group()
def qiita_db():
    pass


@qiita_db.command()
@click.option('--fp', required=True, type=click.Path, exists=True,
              readable=True, resolve_path=True, multiple=True,
              help='Path to the raw data file. This option can be used '
              'multiple times if there are multiple raw data files.')
@click.option('--filetype', require=True,
              type=click.Choice(get_filetypes().keys()),
              help='The type of data')
@click.option('--study', required=True, multiple=True, help='Associate the '
              'data with this study. This option can be used multiple times '
              'if the data should be associated with multiple studies')
def load_raw_data(fp, filetype, study):
    data.load_raw(fp, filetype, study)


@click.command()
@click.option('--owner', help="The email address of the owner of the study")
@click.option('--title', help="The title of the study")
@click.option('--info', type=click.File(mode='r'),
              help="filepath of file with study information in python"
              "config file format")
def insert_study_to_db(owner, title, info):
    make_study_from_cmd(owner, title, info)


qiita_db.add_command(make_test_env)
qiita_db.add_command(clean_test_env)
qiita_db.add_command(drop_test_env)
qiita_db.add_command(make_production_env)
qiita_db.add_command(make_demo_env)
qiita_db.add_command(drop_demo_env)
qiita_db.add_command(insert_study_to_db)

if __name__ == '__main__':
    qiita_db()
